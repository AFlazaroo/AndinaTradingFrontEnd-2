<div class="ordenes-enviadas-container p-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h2 class="text-white mb-2">
        <i class="bi bi-inbox me-2"></i>
        Órdenes Enviadas
      </h2>
      <p class="text-muted">Historial de órdenes de compra enviadas a traders</p>
    </div>
    <button class="btn btn-primary" (click)="cargarOrdenes()">
      <i class="bi bi-arrow-clockwise me-2"></i>
      Actualizar
    </button>
  </div>

  <!-- Error -->
  <div *ngIf="errorMessage" class="alert alert-danger alert-dismissible fade show" role="alert">
    <i class="bi bi-exclamation-triangle-fill me-2"></i>
    {{ errorMessage }}
    <button type="button" class="btn-close" (click)="errorMessage = ''" aria-label="Cerrar"></button>
  </div>

  <!-- Spinner -->
  <div *ngIf="loading" class="text-center my-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <p class="text-white mt-3">Cargando órdenes...</p>
  </div>

  <!-- Tabla de Órdenes -->
  <div *ngIf="!loading" class="card">
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-hover mb-0">
          <thead>
            <tr>
              <th>ID</th>
              <th>Trader</th>
              <th>Símbolo</th>
              <th>Cantidad</th>
              <th>Precio Límite</th>
              <th>Estado</th>
              <th>Fecha</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngIf="ordenes.length === 0">
              <td colspan="8" class="text-center text-muted py-4">
                <i class="bi bi-inbox me-2"></i>
                No has enviado ninguna orden todavía
              </td>
            </tr>
            <tr *ngFor="let orden of ordenes" class="table-row">
              <td>{{ orden.id }}</td>
              <td>
                <strong>Trader #{{ orden.idTrader }}</strong>
              </td>
              <td>
                <strong>{{ orden.simbolo }}</strong>
                <small class="d-block text-muted" *ngIf="orden.nombreEmpresa">{{ orden.nombreEmpresa }}</small>
              </td>
              <td>{{ orden.cantidad }}</td>
              <td>
                <span *ngIf="orden.precioLimite">${{ orden.precioLimite.toFixed(2) }}</span>
                <span *ngIf="!orden.precioLimite" class="text-muted">Sin límite</span>
              </td>
              <td>
                <span class="badge" [ngClass]="getEstadoBadgeClass(orden.estado)">
                  {{ getEstadoTexto(orden.estado) }}
                </span>
              </td>
              <td>
                <small>{{ formatearFecha(orden.fechaCreacion) }}</small>
              </td>
              <td>
                <button 
                  class="btn btn-sm btn-primary"
                  (click)="verDetalles(orden)">
                  <i class="bi bi-eye me-1"></i>
                  Ver Detalles
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="card-footer bg-transparent border-top border-secondary">
      <small class="text-muted">
        Total: {{ ordenes.length }} orden(es)
      </small>
    </div>
  </div>

  <!-- Modal de Detalles -->
  <div *ngIf="ordenSeleccionada" class="modal fade show d-block" tabindex="-1" style="background-color: rgba(0,0,0,0.5);">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">
            <i class="bi bi-file-text me-2"></i>
            Detalles de la Orden #{{ ordenSeleccionada.id }}
          </h5>
          <button type="button" class="btn-close" (click)="cerrarDetalles()" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <div class="row mb-3">
            <div class="col-md-6 mb-3">
              <div class="info-item">
                <label class="info-label">ID de Orden</label>
                <p class="info-value">{{ ordenSeleccionada.id }}</p>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <div class="info-item">
                <label class="info-label">Estado</label>
                <p class="info-value">
                  <span class="badge" [ngClass]="getEstadoBadgeClass(ordenSeleccionada.estado)">
                    {{ getEstadoTexto(ordenSeleccionada.estado) }}
                  </span>
                </p>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <div class="info-item">
                <label class="info-label">Símbolo</label>
                <p class="info-value">{{ ordenSeleccionada.simbolo }}</p>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <div class="info-item">
                <label class="info-label">Nombre Empresa</label>
                <p class="info-value">{{ ordenSeleccionada.nombreEmpresa || 'N/A' }}</p>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <div class="info-item">
                <label class="info-label">Cantidad</label>
                <p class="info-value">{{ ordenSeleccionada.cantidad }} acciones</p>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <div class="info-item">
                <label class="info-label">Precio Límite</label>
                <p class="info-value">
                  <span *ngIf="ordenSeleccionada.precioLimite">${{ ordenSeleccionada.precioLimite.toFixed(2) }}</span>
                  <span *ngIf="!ordenSeleccionada.precioLimite" class="text-muted">Sin límite</span>
                </p>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <div class="info-item">
                <label class="info-label">Trader ID</label>
                <p class="info-value">{{ ordenSeleccionada.idTrader }}</p>
              </div>
            </div>
            <div class="col-md-6 mb-3">
              <div class="info-item">
                <label class="info-label">Fecha Creación</label>
                <p class="info-value">{{ formatearFecha(ordenSeleccionada.fechaCreacion) }}</p>
              </div>
            </div>
            <div class="col-md-6 mb-3" *ngIf="ordenSeleccionada.fechaAceptacion">
              <div class="info-item">
                <label class="info-label">Fecha Aceptación</label>
                <p class="info-value">{{ formatearFecha(ordenSeleccionada.fechaAceptacion!) }}</p>
              </div>
            </div>
            <div class="col-md-6 mb-3" *ngIf="ordenSeleccionada.fechaEjecucion">
              <div class="info-item">
                <label class="info-label">Fecha Ejecución</label>
                <p class="info-value">{{ formatearFecha(ordenSeleccionada.fechaEjecucion!) }}</p>
              </div>
            </div>
            <div class="col-md-6 mb-3" *ngIf="ordenSeleccionada.precioEjecucion">
              <div class="info-item">
                <label class="info-label">Precio de Ejecución</label>
                <p class="info-value text-success">${{ ordenSeleccionada.precioEjecucion.toFixed(2) }}</p>
              </div>
            </div>
            <div class="col-12 mb-3" *ngIf="ordenSeleccionada.mensaje">
              <div class="info-item">
                <label class="info-label">Mensaje</label>
                <p class="info-value">{{ ordenSeleccionada.mensaje }}</p>
              </div>
            </div>
            <div class="col-12 mb-3" *ngIf="ordenSeleccionada.errorMensaje">
              <div class="info-item">
                <label class="info-label text-danger">Error</label>
                <p class="info-value text-danger">{{ ordenSeleccionada.errorMensaje }}</p>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" (click)="cerrarDetalles()">
            <i class="bi bi-x-circle me-2"></i>
            Cerrar
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

